<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admisión - Sistema de Gestión APS y Clínica</title>
    <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen flex">
        <!-- Sidebar -->
        <aside class="w-64 bg-primary-800 text-white hidden md:block">
            <div class="p-4 flex items-center border-b border-primary-700">
                <i class="fas fa-clinic-medical text-2xl mr-3"></i>
                <h1 class="text-xl font-semibold">APS Sistema</h1>
            </div>
            <nav class="mt-5">
                <a href="index.html" class="flex items-center py-3 px-4 hover:bg-primary-700 transition-colors">
                    <i class="fas fa-home w-6"></i>
                    <span>Inicio</span>
                </a>
                <a href="admision.html" class="flex items-center py-3 px-4 bg-primary-700">
                    <i class="fas fa-user-plus w-6"></i>
                    <span>Admisión</span>
                </a>
                <a href="consultas.html" class="flex items-center py-3 px-4 hover:bg-primary-700 transition-colors">
                    <i class="fas fa-stethoscope w-6"></i>
                    <span>Consultas Médicas</span>
                </a>
                <a href="laboratorio.html" class="flex items-center py-3 px-4 hover:bg-primary-700 transition-colors">
                    <i class="fas fa-flask w-6"></i>
                    <span>Laboratorio</span>
                </a>
                <a href="imagenologia.html" class="flex items-center py-3 px-4 hover:bg-primary-700 transition-colors">
                    <i class="fas fa-x-ray w-6"></i>
                    <span>Imagenología</span>
                </a>
                <a href="admin.html" class="flex items-center py-3 px-4 hover:bg-primary-700 transition-colors">
                    <i class="fas fa-cog w-6"></i>
                    <span>Administración</span>
                </a>
                <a href="reportes.html" class="flex items-center py-3 px-4 hover:bg-primary-700 transition-colors">
                    <i class="fas fa-chart-bar w-6"></i>
                    <span>Reportes</span>
                </a>
            </nav>
        </aside>

        <!-- Main content -->
        <div class="flex-1 flex flex-col">
            <!-- Top navbar -->
            <header class="bg-white shadow-sm">
                <div class="flex justify-between items-center px-4 py-3">
                    <button class="md:hidden text-gray-600">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div class="flex items-center space-x-4">
                        <div class="relative">
                            <i class="fas fa-bell text-gray-500"></i>
                            <span class="absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 text-xs flex items-center justify-center">3</span>
                        </div>
                        <div class="flex items-center">
                            <img src="https://randomuser.me/api/portraits/women/28.jpg" alt="Profile" class="w-8 h-8 rounded-full">
                            <span class="ml-2 text-sm font-medium text-gray-700">Ana Gómez</span>
                            <i class="fas fa-chevron-down ml-2 text-xs text-gray-500"></i>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Admisión content -->
            <main class="flex-1 p-5">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-semibold text-gray-800">Admisión de Pacientes</h2>
                    <div class="flex space-x-2">
                        <button id="openModalBtn" class="bg-primary-600 text-white px-4 py-2 rounded-lg flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            <span>Nuevo Paciente</span>
                        </button>
                    </div>
                </div>

                <!-- Search and filters -->
                <div class="bg-white rounded-lg shadow p-5 mb-6">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                        <div class="flex-1 md:mr-4">
                            <div class="relative">
                                <input type="text" id="patient-search" placeholder="Buscar paciente por cédula..." class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                        </div>
                        <div class="flex space-x-2">
                            <button id="search-patient-btn" class="bg-primary-600 text-white px-4 py-2 rounded-lg flex items-center">
                                <i class="fas fa-search mr-2"></i>
                                <span>Buscar</span>
                            </button>
                            <button class="bg-primary-100 text-primary-700 px-4 py-2 rounded-lg flex items-center">
                                <i class="fas fa-filter mr-2"></i>
                                <span>Filtros</span>
                            </button>
                            <button class="bg-primary-100 text-primary-700 px-4 py-2 rounded-lg">
                                <i class="fas fa-sync-alt"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Quick access cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-6">
                    <div class="bg-white rounded-lg shadow p-5 border-l-4 border-blue-500">
                        <h3 class="text-lg font-medium text-gray-800 mb-2">Consulta Médica</h3>
                        <p class="text-gray-600 mb-4">Asignar paciente a consulta médica con especialista</p>
                        <button class="bg-blue-500 text-white px-4 py-2 rounded-lg w-full">Asignar</button>
                    </div>
                    <div class="bg-white rounded-lg shadow p-5 border-l-4 border-green-500">
                        <h3 class="text-lg font-medium text-gray-800 mb-2">Laboratorio</h3>
                        <p class="text-gray-600 mb-4">Asignar paciente para exámenes de laboratorio</p>
                        <button class="bg-green-500 text-white px-4 py-2 rounded-lg w-full">Asignar</button>
                    </div>
                    <div class="bg-white rounded-lg shadow p-5 border-l-4 border-purple-500">
                        <h3 class="text-lg font-medium text-gray-800 mb-2">Imagenología</h3>
                        <p class="text-gray-600 mb-4">Asignar paciente para estudios de imagen</p>
                        <button class="bg-purple-500 text-white px-4 py-2 rounded-lg w-full">Asignar</button>
                    </div>
                </div>

                <!-- Order registration form -->
                <div class="bg-white rounded-lg shadow mb-6">
                    <div class="p-5 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-lg font-medium text-gray-800">Registro de Nueva Orden</h3>
                        <div class="text-sm text-gray-500">Fecha: <span id="current-date">20/04/2025</span></div>
                    </div>
                    <div class="p-5">
                        <form class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Patient Information (Auto-filled) -->
                            <div class="md:col-span-2">
                                <h4 class="text-md font-medium text-gray-700 mb-3">Información del Paciente</h4>
                                <div class="bg-blue-50 p-3 rounded-lg mb-3 border border-blue-200">
                                    <p class="text-sm text-blue-700">La información del paciente se rellenará automáticamente al buscar por cédula en el formulario superior.</p>
                                </div>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Cédula de Identidad</label>
                                <input type="text" id="patient-id" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Nombres y Apellidos</label>
                                <input type="text" id="patient-name" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Fecha de Nacimiento</label>
                                <input type="text" id="patient-dob" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Género</label>
                                <input type="text" id="patient-gender" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>

                            <!-- Contact Information (Auto-filled) -->
                            <div class="md:col-span-2 mt-4">
                                <h4 class="text-md font-medium text-gray-700 mb-3">Información de Contacto</h4>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Teléfono</label>
                                <input type="tel" id="patient-phone" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Correo Electrónico</label>
                                <input type="email" id="patient-email" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>
                            <div class="space-y-2 md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700">Dirección</label>
                                <input type="text" id="patient-address" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>

                            <!-- Insurance Information (Auto-filled) -->
                            <div class="md:col-span-2 mt-4">
                                <h4 class="text-md font-medium text-gray-700 mb-3">Información de Seguro</h4>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Aseguradora</label>
                                <input type="text" id="patient-insurance" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Número de Póliza</label>
                                <input type="text" id="patient-policy" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>

                            <!-- Order Information -->
                            <div class="md:col-span-2 mt-4">
                                <h4 class="text-md font-medium text-gray-700 mb-3">Información de la Orden</h4>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Número de Orden</label>
                                <input type="text" id="order-number" value="ORD-2025042001" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 bg-gray-100" readonly>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Prioridad</label>
                                <select class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                                    <option>Normal</option>
                                    <option>Urgente</option>
                                    <option>Emergencia</option>
                                </select>
                            </div>
                            <div class="space-y-2 md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700">Notas Adicionales</label>
                                <textarea class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" rows="3" placeholder="Ingrese notas o instrucciones especiales para esta orden..."></textarea>
                            </div>

                            <!-- Service Assignment -->
                            <div class="md:col-span-2 mt-4">
                                <h4 class="text-md font-medium text-gray-700 mb-3">Asignación de Servicio</h4>
                            </div>
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Tipo de Servicio</label>
                                <select class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" id="service-type">
                                    <option value="">Seleccionar...</option>
                                    <option value="consulta">Consulta Médica</option>
                                    <option value="laboratorio">Laboratorio</option>
                                    <option value="imagenologia">Imagenología</option>
                                </select>
                            </div>
                            <div class="space-y-2" id="specialty-container" style="display: none;">
                                <label class="block text-sm font-medium text-gray-700">Especialidad</label>
                                <select class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" id="specialty">
                                    <option>Seleccionar...</option>
                                    <option>Medicina General</option>
                                    <option>Pediatría</option>
                                    <option>Ginecología</option>
                                    <option>Cardiología</option>
                                    <option>Traumatología</option>
                                </select>
                            </div>

                            <div class="space-y-2" id="doctor-container" style="display: none;">
                                <label class="block text-sm font-medium text-gray-700">Doctor</label>
                                <select class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                                    <option>Seleccionar...</option>
                                    <option>Dr. Juan Pérez</option>
                                    <option>Dra. María González</option>
                                    <option>Dr. Carlos Rodríguez</option>
                                </select>
                            </div>

                            <div class="space-y-2" id="exam-container" style="display: none;">
                                <label class="block text-sm font-medium text-gray-700">Tipo de Examen</label>
                                <select class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                                    <option>Seleccionar...</option>
                                    <option>Hemograma Completo</option>
                                    <option>Perfil Bioquímico</option>
                                    <option>Perfil Lipídico</option>
                                    <option>Examen de Orina</option>
                                </select>
                            </div>

                            <div class="space-y-2" id="imaging-container" style="display: none;">
                                <label class="block text-sm font-medium text-gray-700">Tipo de Estudio</label>
                                <select class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                                    <option>Seleccionar...</option>
                                    <option>Ecografía Abdominal</option>
                                    <option>Radiografía de Tórax</option>
                                    <option>Ecografía Obstétrica</option>
                                </select>
                            </div>

                            <!-- Submit button -->
                            <div class="md:col-span-2 mt-6 flex justify-end">
                                <button type="button" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg mr-2">Cancelar</button>
                                <button type="submit" class="bg-primary-600 text-white px-6 py-2 rounded-lg">Crear Orden</button>
                            </div>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Patient Registration Modal -->
    <div id="patientModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-lg w-full max-w-4xl max-h-screen overflow-y-auto">
            <div class="p-5 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white z-10">
                <h3 class="text-lg font-medium text-gray-800">Registro de Nuevo Paciente</h3>
                <button id="closeModalBtn" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-5">
                <form class="grid grid-cols-1 md:grid-cols-2 gap-6" id="patientRegistrationForm">
                    <!-- Personal Information -->
                    <div class="md:col-span-2">
                        <h4 class="text-md font-medium text-gray-700 mb-3">Información Personal</h4>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Cédula de Identidad *</label>
                        <input type="text" name="idNumber" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" required>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Nombres *</label>
                        <input type="text" name="firstName" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" required>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Apellidos *</label>
                        <input type="text" name="lastName" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" required>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Fecha de Nacimiento *</label>
                        <input type="date" name="dob" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" required>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Género *</label>
                        <select name="gender" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" required>
                            <option value="">Seleccionar...</option>
                            <option value="Masculino">Masculino</option>
                            <option value="Femenino">Femenino</option>
                            <option value="Otro">Otro</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Estado Civil</label>
                        <select name="maritalStatus" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                            <option value="">Seleccionar...</option>
                            <option value="Soltero/a">Soltero/a</option>
                            <option value="Casado/a">Casado/a</option>
                            <option value="Divorciado/a">Divorciado/a</option>
                            <option value="Viudo/a">Viudo/a</option>
                        </select>
                    </div>

                    <!-- Contact Information -->
                    <div class="md:col-span-2 mt-4">
                        <h4 class="text-md font-medium text-gray-700 mb-3">Información de Contacto</h4>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Teléfono *</label>
                        <input type="tel" name="phone" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" required>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Correo Electrónico</label>
                        <input type="email" name="email" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                    </div>
                    <div class="space-y-2 md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700">Dirección *</label>
                        <input type="text" name="address" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500" required>
                    </div>

                    <!-- Insurance Information -->
                    <div class="md:col-span-2 mt-4">
                        <h4 class="text-md font-medium text-gray-700 mb-3">Información de Seguro</h4>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Aseguradora</label>
                        <select name="insurance" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                            <option value="">Seleccionar...</option>
                            <option value="Seguro Nacional de Salud">Seguro Nacional de Salud</option>
                            <option value="Seguro Privado A">Seguro Privado A</option>
                            <option value="Seguro Privado B">Seguro Privado B</option>
                            <option value="Sin Seguro">Sin Seguro</option>
                        </select>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Número de Póliza</label>
                        <input type="text" name="policyNumber" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                    </div>

                    <!-- Emergency Contact -->
                    <div class="md:col-span-2 mt-4">
                        <h4 class="text-md font-medium text-gray-700 mb-3">Contacto de Emergencia</h4>
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Nombre Completo</label>
                        <input type="text" name="emergencyName" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Teléfono</label>
                        <input type="tel" name="emergencyPhone" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                    </div>
                    <div class="space-y-2">
                        <label class="block text-sm font-medium text-gray-700">Relación</label>
                        <select name="emergencyRelation" class="w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500">
                            <option value="">Seleccionar...</option>
                            <option value="Cónyuge">Cónyuge</option>
                            <option value="Padre/Madre">Padre/Madre</option>
                            <option value="Hijo/a">Hijo/a</option>
                            <option value="Hermano/a">Hermano/a</option>
                            <option value="Otro Familiar">Otro Familiar</option>
                            <option value="Amigo/a">Amigo/a</option>
                        </select>
                    </div>

                    <!-- Submit button -->
                    <div class="md:col-span-2 mt-6 flex justify-end">
                        <button type="button" id="cancelPatientBtn" class="bg-gray-200 text-gray-700 px-6 py-2 rounded-lg mr-2">Cancelar</button>
                        <button type="submit" class="bg-primary-600 text-white px-6 py-2 rounded-lg">Registrar Paciente</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Set current date
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const formattedDate = today.getDate().toString().padStart(2, '0') + '/' + 
                                (today.getMonth() + 1).toString().padStart(2, '0') + '/' + 
                                today.getFullYear();
            document.getElementById('current-date').textContent = formattedDate;
        });
        
        // Mobile menu toggle
        document.querySelector('header button').addEventListener('click', function() {
            const sidebar = document.querySelector('aside');
            sidebar.classList.toggle('hidden');
        });

        // Service type selection logic
        document.getElementById('service-type').addEventListener('change', function() {
            const specialtyContainer = document.getElementById('specialty-container');
            const doctorContainer = document.getElementById('doctor-container');
            const examContainer = document.getElementById('exam-container');
            const imagingContainer = document.getElementById('imaging-container');
            
            // Hide all containers first
            specialtyContainer.style.display = 'none';
            doctorContainer.style.display = 'none';
            examContainer.style.display = 'none';
            imagingContainer.style.display = 'none';
            
            // Show relevant containers based on selection
            if (this.value === 'consulta') {
                specialtyContainer.style.display = 'block';
                doctorContainer.style.display = 'block';
            } else if (this.value === 'laboratorio') {
                examContainer.style.display = 'block';
            } else if (this.value === 'imagenologia') {
                imagingContainer.style.display = 'block';
            }
        });
        
        // Modal functionality
        const modal = document.getElementById('patientModal');
        const openModalBtn = document.getElementById('openModalBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const cancelPatientBtn = document.getElementById('cancelPatientBtn');
        const patientForm = document.getElementById('patientRegistrationForm');

        // Open modal
        openModalBtn.addEventListener('click', function() {
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Prevent scrolling when modal is open
        });

        // Close modal functions
        function closeModal() {
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // Re-enable scrolling
            patientForm.reset(); // Reset form when closing
        }

        closeModalBtn.addEventListener('click', closeModal);
        cancelPatientBtn.addEventListener('click', closeModal);

        // Close modal when clicking outside
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                closeModal();
            }
        });

        // Form submission
        patientForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = new FormData(patientForm);
            const patientData = {};
            for (const [key, value] of formData.entries()) {
                patientData[key] = value;
            }
            
            // In a real application, you would send this data to your backend API
            console.log('Patient data to be submitted:', patientData);
            
            // For demo purposes, show success message and close modal
            alert('Paciente registrado exitosamente.');
            closeModal();
            
            // Optionally, you could auto-fill the order form with the new patient's data
            document.getElementById('patient-id').value = patientData.idNumber;
            document.getElementById('patient-name').value = patientData.firstName + ' ' + patientData.lastName;
            document.getElementById('patient-dob').value = patientData.dob;
            document.getElementById('patient-gender').value = patientData.gender;
            document.getElementById('patient-phone').value = patientData.phone;
            document.getElementById('patient-email').value = patientData.email;
            document.getElementById('patient-address').value = patientData.address;
            document.getElementById('patient-insurance').value = patientData.insurance;
            document.getElementById('patient-policy').value = patientData.policyNumber;
        });

        // Patient search functionality
        document.getElementById('search-patient-btn').addEventListener('click', function() {
            const patientId = document.getElementById('patient-search').value.trim();
            if (patientId) {
                // Simulate API call to fetch patient data
                // In a real application, this would be an actual API call
                setTimeout(() => {
                    // Mock patient data (in a real app, this would come from the server)
                    const patientData = {
                        id: patientId,
                        name: 'Juan Carlos Pérez González',
                        dob: '15/08/1985',
                        gender: 'Masculino',
                        phone: '+56 9 8765 4321',
                        email: 'juan.perez@ejemplo.com',
                        address: 'Av. Principal 123, Santiago',
                        insurance: 'Seguro Nacional de Salud',
                        policy: 'SNS-12345678'
                    };
                    
                    // Fill the form with patient data
                    document.getElementById('patient-id').value = patientData.id;
                    document.getElementById('patient-name').value = patientData.name;
                    document.getElementById('patient-dob').value = patientData.dob;
                    document.getElementById('patient-gender').value = patientData.gender;
                    document.getElementById('patient-phone').value = patientData.phone;
                    document.getElementById('patient-email').value = patientData.email;
                    document.getElementById('patient-address').value = patientData.address;
                    document.getElementById('patient-insurance').value = patientData.insurance;
                    document.getElementById('patient-policy').value = patientData.policy;
                    
                    // Show success message
                    alert('Paciente encontrado. Los datos se han cargado en el formulario.');
                }, 1000);
            } else {
                alert('Por favor ingrese un número de cédula para buscar.');
            }
        });
    </script>
</body>
</html>
